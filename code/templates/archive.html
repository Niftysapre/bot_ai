{% extends "base.html" %}

{% block title %}–ê—Ä—Ö–∏–≤{% endblock %}

{% block header %}–ê—Ä—Ö–∏–≤{% endblock %}

{% block content %}
<!-- –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤–º–µ—Å—Ç–µ —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
<form method="get" action="/archive" class="row g-3 mb-4">
    <div class="col-md-4">
        <input type="text" name="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º" class="form-control" value="{{ request.args.get('search', '') }}">
    </div>
    <div class="col-md-3">
        <select name="status" class="form-select">
            <option value="" {% if not request.args.get('status') %}selected{% endif %}>–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
            <option value="–≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ" {% if request.args.get('status') == "–≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ" %}selected{% endif %}>–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</option>
            <option value="–æ—Ç–≤–µ—á–µ–Ω" {% if request.args.get('status') == "–æ—Ç–≤–µ—á–µ–Ω" %}selected{% endif %}>–û—Ç–≤–µ—á–µ–Ω</option>
        </select>
    </div>
    <div class="col-md-3">
        <select name="priority" class="form-select">
            <option value="">–í—Å–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã</option>
            <option value="1" {% if request.args.get('priority') == '1' %}selected{% endif %}>üü¢ –ù–∏–∑–∫–∏–π</option>
            <option value="2" {% if request.args.get('priority') == '2' %}selected{% endif %}>üü° –°—Ä–µ–¥–Ω–∏–π</option>
            <option value="3" {% if request.args.get('priority') == '3' %}selected{% endif %}>üî¥ –í—ã—Å–æ–∫–∏–π</option>
        </select>
    </div>
    <div class="col-md-2 d-flex align-items-center justify-content-end">
        <button type="submit" class="btn btn-primary me-2">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
        <a href="/archive" class="btn btn-outline-secondary" title="–°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã">
            <i class="fas fa-redo"></i>
        </a>
        <!-- –ö–Ω–æ–ø–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ —Å –∏–∫–æ–Ω–∫–æ–π –º—É—Å–æ—Ä–∫–∏ -->
        <button type="submit" form="deleteForm" class="btn btn-danger" title="–£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã"
                onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã?');">
            <i class="fas fa-trash"></i>
        </button>
    </div>
</form>

<!-- –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä—ã—Ç—ã–π form –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –≤—Å–µ—Ö –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ -->
<form id="deleteForm" action="{{ url_for('delete_all_archived') }}" method="post" style="display:none;"></form>

<!-- –¢–∞–±–ª–∏—Ü–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ -->
<div class="table-responsive">
    <table class="table table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                <th>–í–æ–ø—Ä–æ—Å</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for question in questions %}
            <tr>
                <td>{{ question.id }}</td>
                <td>{{ question.user_id if question.user_id else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π' }}</td>
                <td>{{ question.question }}</td>
                <td>
                    {% if question.status == '–æ—Ç–≤–µ—á–µ–Ω' %}
                        <span class="badge bg-success">–û—Ç–≤–µ—á–µ–Ω</span>
                    {% else %}
                        <span class="badge bg-warning">–í –æ–±—Ä–∞–±–æ—Ç–∫–µ</span>
                    {% endif %}
                </td>
                <td>
                    {% if question.priority == 1 %}
                        <span class="text-success">üü¢ –ù–∏–∑–∫–∏–π</span>
                    {% elif question.priority == 2 %}
                        <span class="text-warning">üü° –°—Ä–µ–¥–Ω–∏–π</span>
                    {% else %}
                        <span class="text-danger">üî¥ –í—ã—Å–æ–∫–∏–π</span>
                    {% endif %}
                </td>
                <td>
                    <div class="btn-group">
                        <form action="{{ url_for('restore_question', question_id=question.id) }}" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-outline-success">
                                <i class="fas fa-undo"></i>
                            </button>
                        </form>
                        <form action="{{ url_for('delete_question', question_id=question.id) }}" method="post" style="display:inline;">
                            <button type="submit" class="btn btn-sm btn-outline-danger" 
                                    onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –≤–æ–ø—Ä–æ—Å –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ?');">
                                <i class="fas fa-trash"></i>
                            </button>
                        </form>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- –ü–æ—Å–ª–µ —Ç–∞–±–ª–∏—Ü—ã -->
{% set base_args = request.args.to_dict() %}
<nav aria-label="–ü–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è">
    <ul class="pagination justify-content-center">
        {% if page > 1 %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('archive', **(base_args|combine({'page': page-1}))) }}">–ü—Ä–µ–¥—ã–¥—É—â–∞—è</a>
        </li>
        {% endif %}
        {% for p in range(1, total_pages + 1) %}
        <li class="page-item {% if p == page %}active{% endif %}">
            <a class="page-link" href="{{ url_for('archive', **(base_args|combine({'page': p}))) }}">{{ p }}</a>
        </li>
        {% endfor %}
        {% if page < total_pages %}
        <li class="page-item">
            <a class="page-link" href="{{ url_for('archive', **(base_args|combine({'page': page+1}))) }}">–°–ª–µ–¥—É—é—â–∞—è</a>
        </li>
        {% endif %}
    </ul>
</nav>
{% endblock %}



